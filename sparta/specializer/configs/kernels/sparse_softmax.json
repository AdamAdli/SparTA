
{
    "op_name": "sparse_softmax",
    "factory_type": "template",
    "kernel_name": "sparse_softmax",
    "dynamic_dims": [
        "GLOBAL_H_VALUE",
        "GLOBAL_W_VALUE",
        "BLOCK_SIZE_H_VALUE",
        "BLOCK_SIZE_W_VALUE",
        "ROW_TILE_VALUE"
    ],
    "fixed_dims": {
        "COMPRESSED": true
    },
    "inputs": {
        "C_in": {
            "type": "float",
            "shape": ["GLOBAL_H_VALUE", "GLOBAL_W_VALUE"],
            "layout": "bcsr",
            "mode": "H",
            "block_size": ["BLOCK_SIZE_H_VALUE", "BLOCK_SIZE_W_VALUE"]
        }
    },
    "outputs": {
        "C_out": {
            "type": "float",
            "shape": ["GLOBAL_H_VALUE", "GLOBAL_W_VALUE"],
            "layout": "dense",
            "formula": "np.exp(x - np.max(x)) / np.sum(np.exp(x - np.max(x)), axis=-1).reshape((-1, 1))"
        }
    },
    "tiles": {
        "block": ["ROW_TILE_VALUE * BLOCK_SIZE_W_VALUE"],
        "grid": ["GLOBAL_H_VALUE // ROW_TILE_VALUE"]
    }
}
